jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
}
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- FALSE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
}
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- TRUE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
}
source("/Users/AadishShah/Desktop/Projects.nosync/Allada\ Lab\ Downloads/Brain_Seq/helper_functions.R")
getwd()
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
source("/Users/AadishShah/Desktop/Projects.nosync/Allada\ Lab\ Downloads/Brain_Seq/helper_functions.R")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets")
source("/Users/AadishShah/Desktop/Projects.nosync/Allada\ Lab\ Downloads/Brain_Seq/helper_functions.R")
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets")
library(openxlsx)   # For Excel file operations
library(dplyr)      # Optional, for data manipulation if used
library(readr)      # Optional, for reading and writing CSV files
library(stringr)    # Optional, for string manipulation (e.g., grepl, str_trim)
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets")
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- TRUE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if("flybase_gene_id" %in% names(df_list[[dfn]])){
df_list[[dfn]] <- df_list[[dfn]] %>%
select(-flybase_gene_id)
}
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/")
}
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- FALSE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if("flybase_gene_id" %in% names(df_list[[dfn]])){
df_list[[dfn]] <- df_list[[dfn]] %>%
select(-flybase_gene_id)
}
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/")
}
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- FALSE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if("flybase_gene_id" %in% names(df_list[[dfn]])){
df_list[[dfn]] <- df_list[[dfn]] %>%
select(-flybase_gene_id)
}
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/")
}
df_list <- read_all_csvs_recursive("Data/Consistent_Sleep_Wake/")
target_df <- df_list$Atx2_RIP_IP_Up_regulated_genes
df_list <- df_list[!names(df_list) %in% "Atx2_RIP_IP_Up_regulated_genes"]
df_list <- df_list[!grepl("<", names(df_list)) & !grepl("Jaccard", names(df_list))]
print(names(df_list))
print(length(df_list))
##---
all_genes <- TRUE # Toggle to TRUE for no filtering
##---
# Initialize a list to store all rows
jaccard_list <- list()
# Loop over df_list and calculate Jaccard index
for(dfn in names(df_list)){
if("flybase_gene_id" %in% names(df_list[[dfn]])){
df_list[[dfn]] <- df_list[[dfn]] %>%
select(-flybase_gene_id)
}
if(all_genes == FALSE){
df_list[[dfn]] <- df_list[[dfn]] %>%
filter(frequency >= 2)
}
# Initialize a new row list
new_row <- list(
"Gene_Set_Name" = dfn,
"Gene_Set_Size" = nrow(df_list[[dfn]]),
"Target_Set_Name" = "Atx2_RIP_IP_Up_regulated_genes",
"Target_Set_Size" = nrow(target_df)
)
# Extract unique genes from both sets
consistent_sleep_wake_genes <- unique(df_list[[dfn]]$ext_gene)
target_df_genes <- unique(target_df$ext_gene)
# Find intersect and union
common_genes <- intersect(consistent_sleep_wake_genes, target_df_genes)
union_genes <- union(consistent_sleep_wake_genes, target_df_genes)
# Calculate Intersect, Union, and Jaccard Index
new_row[["Intersect"]] <- length(common_genes)
new_row[["Union"]] <- length(union_genes)
new_row[["Jaccard_Index"]] <- ifelse(!is.na(new_row[["Intersect"]] / new_row[["Union"]]), new_row[["Intersect"]] / new_row[["Union"]], 0)
# Append new row to list
jaccard_list[[dfn]] <- new_row
# Save the result of common genes
result_dfn <- paste0(dfn, "<overlap>", "Atx2_RIP_IP_Up_regulated_genes")
result_df <- df_list[[dfn]][df_list[[dfn]]$ext_gene %in% common_genes,]
result_df <- get_sig_frequency_col(result_df %>% select(-frequency), experiments = c(names(result_df %>% select(-frequency, -ext_gene, -X))))
if (all_genes == TRUE){
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/", result_dfn, ".csv"))
} else{
write_csv(result_df, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/", result_dfn, ".csv"))
}
}
# Convert the list of rows to a data frame
jaccard_table <- as.data.frame(do.call(rbind, lapply(jaccard_list, as.data.frame))) %>%
arrange(desc(Jaccard_Index))
if(all_genes){
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_All/Gene_Sets/")
} else{
write_csv(jaccard_table, paste0("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/Jaccard_Scores.csv"))
format_all_results_excel_in_place("Data/Consistent_Sleep_Wake/Atx2_RIP_IP_Common_Genes_min_prefiltered_exp_freq_2/Gene_Sets/")
}
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
names(db_list)
fb_stock <- db_list$Stock_Data_stocks_FB2024_04
print(fb_stock[fb_stock$stock_number == "42566"])
db_list$entity_publication_fb_2024_04[FlyBase_publication_id == "FBrf0212437"]
nrow(db_list$entity_publication_fb_2024_04[FlyBase_publication_id == "FBrf0212437"])
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
runApp('~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI')
fb_stock[fb_stock$stock_number == "HMJ02224"]
fb_stock[fb_stock$FB_genotype == "y[1] v[1]; P{TRiP.JF03151}attP2"]
fb_stock[fb_stock$stock_number == "28724"]
nrow(fb_stock[fb_stock$stock_number == "28724"])
getwd()
setwd("~/Desktop/Projects.nosync/Allada Lab Downloads/Fly_Stock_Scrapers/BDSC_RNAi_Stock_Search_GUI")
db_list <- read_all_tsvs_as_dt_recursive("data")
names(db_list)
db_list <- read_all_tsvs_as_dt_recursive("../Data/FlyBase/")
names(db_lsit)
names(db_list)
pheno <- db_list$Phenotypic_Data_genotype_phenotype_data_fb_2024_04
names(pheno)
db_list <- read_all_tsvs_as_dt_recursive("../Data/FlyBase/")
pheno <- db_list$Phenotypic_Data_genotype_phenotype_data_fb_2024_04
names(pheno)
pheno[pheno$genotype_symbols == "PBac{GMR30A03-lexA}VK00027"]
pheno[grepl("PBac{GMR30A03-lexA}VK00027”, pheno$genotype_symbols)]
pheno[grepl("PBac{GMR30A03-lexA}VK00027”, pheno$genotype_symbols),]
names(pheno)
pheno[grepl("PBac{GMR30A03-lexA}VK00027", pheno$genotype_symbols),]
pheno[grepl("PBac{GMR30A03-lexA}VK00027", pheno$genotype_symbols), ]
pheno[grepl('PBac{GMR30A03-lexA}VK00027', pheno$genotype_symbols), ]
pheno[grepl("PBac{GMR30A03-lexA}VK00027", pheno$genotype_symbols, fixed = TRUE), ]
pheno[grepl("PBac\\{GMR30A03-lexA\\}VK00027", pheno$genotype_symbols, fixed = TRUE), ]
names(pheno)
pheno[grepl("PBac{GMR30A03-lexA}VK00027", pheno$genotype_symbols, fixed = TRUE), ]
head(pheno)
pheno[grepl("y[1] sc[*] v[1] sev[21]; P{y[+t7.7] v[+t1.8]=TRiP.HMS01638}attP407", pheno$genotype_symbols, fixed = TRUE), ]
pheno[grepl("Nrg[849]", pheno$genotype_symbols, fixed = TRUE), ]
pheno[pheno$genotype_symbols == "Nrg[849]"]
insertion_map <- db_list$insertion_mapping_fb_2024_04
db_list <- read_all_tsvs_as_dt_recursive("../Data/FlyBase/")
insertion_map <- db_list$insertion_mapping_fb_2024_04
names(insertion_map)
insertion_map[insertion_map$insertion_symbol == "w[1118]; P{y[+t7.7] w[+mC]=R30E05-p65.AD}attP40; MKRS/TM6B, Tb[1]"]
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7] w[+mC]=R30E05-p65.AD}attP40; MKRS/TM6B, Tb[1]"]
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7] w[+mC]=R30E05-p65.AD}attP40"]
insertion_map[insertion_map$insertion_symbol == "w[+mC]=R30E05-p65.AD}attP40"]
w[1118]; P{R30E05-p65.AD}attP40; MKRS/TM6B, Tb[1]
insertion_map[insertion_map$insertion_symbol == "w[1118]; P{R30E05-p65.AD}attP40; MKRS/TM6B, Tb[1]"]
head(insertion_map)
synon <- db_list$fb_synonym_fb_2024_04
names(synon)
db_list <- read_all_tsvs_as_dt_recursive("../Data/FlyBase/")
synon <- db_list$fb_synonym_fb_2024_04
head(synon)
insertion_map[insertion_map$insertion_symbol == "neoFRT"]
insertion_map <- db_list$insertion_mapping_fb_2024_04
insertion_map[insertion_map$insertion_symbol == "neoFRT"]
head(insertion_map)
insertion_map[insertion_map$insertion_symbol == " P{neoFRT}19A/FM7c"]
insertion_map[insertion_map$insertion_symbol == " P{neoFRT}"]
insertion_map[grepl("neoFRT", insertion_map$insertion_symbol)]
insertion_map[grepl("P{neoFRT}19A/FM7c", insertion_map$insertion_symbol, fixed = TRUE)]
insertion_map[grepl("P{neoFRT}", insertion_map$insertion_symbol)]
insertion_map[grepl("P{neoFRT}", insertion_map$insertion_symbol, fixed = TRUE)]
insertion_map[grepl("P{neoFRT}19A", insertion_map$insertion_symbol, fixed = TRUE)]
library(DBI)
con <- dbConnect(RPostgres::Postgres(),
dbname = "flybase",
host = "chado.flybase.org",
port = 5432,
user = "flybase",
password = "")
query <- "SELECT transgene_product_class
FROM stock
WHERE stock.uniquename = 'v27202'"
result <- dbGetQuery(con, query)
db_list$entity_publication_fb_2024_04
db_list <- read_all_tsvs_as_dt_recursive()
db_list <- read_all_tsvs_as_dt_recursive("../Data")
insertion_map <- db_list$insertion_mapping_fb_2024_04
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7] v[+t1.8]=TRiP.GL00656}attP40"]
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7]v[+t1.8]=TRiP.GL00656}attP40"]
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7] v[+t1.8]=TRiP.HMS01638}attP40"]
insertion_map[insertion_map$insertion_symbol == "P{y[+t7.7]v[+t1.8]=TRiP.HMS01638}attP40"]
names(db_list)
db_list$entity_publication_fb_2024_04
entity <- db_list$entity_publication_fb_2024_04
entity[entity$entity_name=="w[1118]; P{GD14467}v27201"]
entity[entity$entity_name=="P{y[+t7.7] v[+t1.8]=TRiP.HMS01638}attP40"]
entity[entity$entity_name=="P{y[+t7.7]v[+t1.8]=TRiP.HMS01638}attP40"]
entity[entity$entity_name=="Nrg[849]"]
entity[entity$entity_name=="P{KK100482}VIE-260B"]
allele <- db_list$Alleles_2_Gene_fbal_to_fbgn_fb_2024_04
head(allele)
db_list <- read_all_tsvs_as_dt_recursive("../Data")
db_list$Alleles_2_Gene_fbal_to_fbgn_fb_2024_04
head(db_list$fbrf_pmid_pmcid_doi_fb_2024_04)
head(db_list$Stock_Data_stocks_FB2024_04)
head(db_list$entity_publication_fb_2024_04)
db_list$Stock_Data_stocks_FB2024_04
head(db_list$Phenotypic_Data_genotype_phenotype_data_fb_2024_04)
pheno[pheno$genotype_symbols == "w[*]; betaTub60D[2] Kr[If-1]/CyO"]
pheno[pheno$genotype_symbols == "Kr[If-1]/CyO"]
pheno[pheno$genotype_symbols == "w[*]; betaTub60D[2] Kr[If-1]/CyO  "]
pheno[pheno$genotype_symbols == "betaTub60D[2]"]
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
bd_list$Allele
db_list$Alleles_2_Gene_fbal_to_fbgn_fb_2024_04
runApp()
runApp()
